local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Arise Crossover - Rimuru Hub",
    LoadingTitle = "Predator Mode Activated",
    LoadingSubtitle = "by Rimuru ðŸ˜ˆ",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "AriseCrossoverHub",
        FileName = "Config"
    }
})

local FarmTab = Window:CreateTab("Auto Farm", 4483362458)

local npcList = {"No NPCs Found"}
local npcMap = {}
local selectedNPC = ""
local autofarm = false

-- Create dropdown with placeholder list
local dropdown = FarmTab:CreateDropdown({
    Name = "Select NPC",
    Options = npcList,
    CurrentOption = npcList[1],
    Flag = "NPCDropdown",
    Callback = function(option)
        selectedNPC = option
    end,
})

-- Function to scan NPCs
local function scanNPCs()
    local npcRoot = workspace:FindFirstChild("__Main") and workspace.__Main:FindFirstChild("__Enemies") and workspace.__Main.__Enemies:FindFirstChild("Client")
    if not npcRoot then return end

    npcList = {}
    npcMap = {}

    for _, npc in pairs(npcRoot:GetChildren()) do
        local displayName = npc.Name
        if npc:FindFirstChild("Humanoid") and npc.Humanoid.DisplayName then
            displayName = npc.Humanoid.DisplayName
        elseif npc:FindFirstChild("Head") and npc.Head:FindFirstChild("NameTag") then
            displayName = npc.Head.NameTag.Text
        elseif npc:FindFirstChild("DisplayName") then
            displayName = npc.DisplayName.Value
        elseif npc:GetAttribute("DisplayName") then
            displayName = npc:GetAttribute("DisplayName")
        end

        if not npcMap[displayName] then
            table.insert(npcList, displayName)
            npcMap[displayName] = npc
        end
    end

    if #npcList == 0 then
        table.insert(npcList, "No NPCs Found")
    end

    dropdown:UpdateOptions(npcList) -- update dropdown dynamically
    selectedNPC = npcList[1] or ""
end

-- Add a refresh button
FarmTab:CreateButton({
    Name = "Refresh NPC List",
    Callback = function()
        scanNPCs()
    end
})

-- Toggle Auto Farm
FarmTab:CreateToggle({
    Name = "Auto Farm NPC",
    CurrentValue = false,
    Flag = "AutoFarmToggle",
    Callback = function(Value)
        autofarm = Value
        game.Players.LocalPlayer:SetAttribute("AutoClick", Value)

        if autofarm then
            task.spawn(function()
                while autofarm do
                    local npcRoot = workspace:FindFirstChild("__Main") and workspace.__Main:FindFirstChild("__Enemies") and workspace.__Main.__Enemies:FindFirstChild("Client")
                    if not npcRoot then task.wait(1) continue end

                    local npcFound = nil
                    for _, npc in pairs(npcRoot:GetChildren()) do
                        local name = npc.Name
                        if npc:FindFirstChild("Humanoid") and npc.Humanoid.DisplayName then
                            name = npc.Humanoid.DisplayName
                        elseif npc:FindFirstChild("Head") and npc.Head:FindFirstChild("NameTag") then
                            name = npc.Head.NameTag.Text
                        elseif npc:FindFirstChild("DisplayName") then
                            name = npc.DisplayName.Value
                        elseif npc:GetAttribute("DisplayName") then
                            name = npc:GetAttribute("DisplayName")
                        end

                        if name == selectedNPC then
                            npcFound = npc
                            break
                        end
                    end

                    local char = game.Players.LocalPlayer.Character
                    if npcFound and npcFound:FindFirstChild("Hitbox") and char and char:FindFirstChild("HumanoidRootPart") then
                        char:MoveTo(npcFound.Hitbox.Position + Vector3.new(0, 3, 0))
                    end
                    task.wait(0.3)
                end
            end)
        end
    end,
})

-- Initial scan
scanNPCs()
