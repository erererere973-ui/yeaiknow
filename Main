-- Load Rayfield UI
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Arise Crossover - Rimuru Hub",
    LoadingTitle = "Predator Mode Activated",
    LoadingSubtitle = "by Rimuru ðŸ˜ˆ",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "AriseCrossoverHub",
        FileName = "Config"
    }
})

local FarmTab = Window:CreateTab("Auto Farm", 4483362458)

-- Enemy root folder
local npcRoot = workspace:WaitForChild("__Main"):WaitForChild("__Enemies"):WaitForChild("Server")

-- Scan for NPCs and get readable names
local npcList = {}
local npcMap = {}

local function scanNPCs()
    npcList = {}
    npcMap = {}
    for _, zone in pairs(npcRoot:GetChildren()) do
        for _, npc in pairs(zone:GetChildren()) do
            local displayName = npc.Name -- fallback
            if npc:FindFirstChild("Humanoid") and npc.Humanoid.DisplayName then
                displayName = npc.Humanoid.DisplayName
            elseif npc:FindFirstChild("Head") and npc.Head:FindFirstChild("NameTag") then
                displayName = npc.Head.NameTag.Text
            elseif npc:GetAttribute("DisplayName") then
                displayName = npc:GetAttribute("DisplayName")
            end

            if not npcMap[displayName] then
                table.insert(npcList, displayName)
                npcMap[displayName] = npc.Name -- store NPC ID for search later
            end
        end
    end
end

scanNPCs()

local selectedNPC = npcList[1] or ""
local autofarm = false

-- Dropdown for NPC selection
FarmTab:CreateDropdown({
    Name = "Select NPC",
    Options = npcList,
    CurrentOption = selectedNPC,
    Flag = "NPCDropdown",
    Callback = function(option)
        selectedNPC = option
    end,
})

-- Toggle Auto Farm
FarmTab:CreateToggle({
    Name = "Auto Farm NPC",
    CurrentValue = false,
    Flag = "AutoFarmToggle",
    Callback = function(Value)
        autofarm = Value
        game.Players.LocalPlayer:SetAttribute("AutoClick", Value) -- toggle AutoClicker

        if autofarm then
            task.spawn(function()
                while autofarm do
                    local npc = nil
                    -- Search all zones for selected NPC
                    for _, zone in pairs(npcRoot:GetChildren()) do
                        npc = zone:FindFirstChild(npcMap[selectedNPC])
                        if npc then break end
                    end

                    local char = game.Players.LocalPlayer.Character
                    if npc and npc:FindFirstChild("HumanoidRootPart") and char and char:FindFirstChild("HumanoidRootPart") then
                        -- Teleport to NPC
                        char:MoveTo(npc.HumanoidRootPart.Position + Vector3.new(0, 3, 0))
                    end
                    task.wait(0.3) -- adjust speed as needed
                end
            end)
        end
    end,
})
